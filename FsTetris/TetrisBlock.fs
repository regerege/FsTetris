namespace FsTetris

module TetrisBlock =
    let private FallBlocks = [
        // ■■■■
        [ 0b00000000111100000000; ]
        [ 0b00000000010000000000; 0b00000000010000000000; 0b00000000010000000000; 0b00000000010000000000; ]
        // ■      
        // ■■■
        [ 0b00000000100000000000; 0b00000000111000000000; ]
        [ 0b00000000011000000000; 0b00000000010000000000; 0b00000000010000000000; ]
        [ 0b00000000111000000000; 0b00000000001000000000; ]
        [ 0b00000000001000000000; 0b00000000001000000000; 0b00000000011000000000; ]
        // 　　■
        // ■■■
        [ 0b00000000001000000000; 0b00000000111000000000; ]
        [ 0b00000000010000000000; 0b00000000010000000000; 0b00000000011000000000; ]
        [ 0b00000000111000000000; 0b00000000100000000000; ]
        [ 0b00000000011000000000; 0b00000000001000000000; 0b00000000001000000000; ]
        // ■■
        // ■■
        [ 0b00000000011000000000; 0b00000000011000000000; ]
        // 　■■
        // ■■　
        [ 0b00000000011000000000; 0b00000000110000000000; ]
        [ 0b00000000010000000000; 0b00000000011000000000; 0b00000000001000000000; ]
        // 　■
        // ■■■
        [ 0b00000000010000000000; 0b00000000111000000000; ]
        [ 0b00000000010000000000; 0b00000000011000000000; 0b00000000010000000000; ]
        [ 0b00000000111000000000; 0b00000000010000000000; ]
        [ 0b00000000001000000000; 0b00000000011000000000; 0b00000000001000000000; ]
        // ■■
        // 　■■　
        [ 0b00000000110000000000; 0b00000000011000000000; ]
        [ 0b00000000001000000000; 0b00000000011000000000; 0b00000000010000000000; ]
        // ■　■
        // ■■■
        [ 0b00000000101000000000; 0b00000000111000000000; ]
        [ 0b00000000011000000000; 0b00000000010000000000; 0b00000000011000000000; ]
        [ 0b00000000111000000000; 0b00000000101000000000; ]
        [ 0b00000000011000000000; 0b00000000010000000000; 0b00000000011000000000; ]
    ]

    /// TODO: ブロックをどのX座標で落とすかを計算する。
    let getFallBlock height =
        let rnd = new System.Random()
        let b = FallBlocks.[rnd.Next(0, FallBlocks.Length)]
        let l = b.Length
        List.append
            <| [ for y = 1 to (4-l) do yield 0 ]@b
            <| [ for y = 0 to height do yield 0]

